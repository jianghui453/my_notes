# 内存映射文件

内存映射文件（映射文件/文件映射）指的是一段虚拟内存逐字节对应于一个文件或类文件的资源，使得应用程序处理映射部分如同访问主内存。

## 优点

增加I/O性能，特别是用于大文件。

## 缺点

对于小文件，内存映射文件会导致碎片空间浪费，因为内存映射总要对齐页边界。

## 应用

- 操作系统用于加载进程。
- 用于多进程的共享内存。
- 对大文件的读写。

## 实现

- 类Unix POSIX函数mmap()。
mmap内存映射原理：（1）线程启动映射过程，并在虚拟地址空间中为映射创建虚拟映射区域。（2）系统在内核空间调用内核函数mmap，实现文件物理地址和进程虚拟地址之间的一一映射关系。（3）进程发起堆这片映射空间的访问。

## 引用

1. [內存映射文件](https://zh.wikipedia.org/wiki/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6)
